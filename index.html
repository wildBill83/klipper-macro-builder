<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Klipper Macro Builder</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Suppress Tailwind production warning
        tailwind.config = {
            corePlugins: {
                preflight: true,
            }
        }
    </script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel" data-type="module">
        const { useState } = React;

import { Copy, Check } from 'lucide-react';

function KlipperMacroBuilder() {
  const [copied, setCopied] = useState(false);
  
  // Start Print Options
  const [startOptions, setStartOptions] = useState({
    bedMeshLoad: true,
    bedMeshCalibrate: false,
    adaptiveMesh: false,
    qglBeforePrint: true,
    zTilt: false,
    homingOverride: true,
    heatSoak: true,
    soakTime: 5,
    nozzlePreHeat: 150,
    purgeLineType: 'adaptive',
    primeBlobSize: 0,
    fanSpeed: 0,
    chamberTemp: 0,
    filamentType: true,
    velocityLimits: true,
    pressureAdvance: true,
    skewCorrection: false,
  });

  // End Print Options
  const [endOptions, setEndOptions] = useState({
    parkPosition: 'back_center',
    parkZ: 'max',
    retract: 5,
    fanCooldown: true,
    cooldownTime: 60,
    disableSteppers: false,
    bedOff: false,
    partCooling: true,
    presentPart: true,
    beep: true,
  });

  const updateStartOption = (key, value) => {
    setStartOptions(prev => ({ ...prev, [key]: value }));
  };

  const updateEndOption = (key, value) => {
    setEndOptions(prev => ({ ...prev, [key]: value }));
  };

  const generateStartMacro = () => {
    let macro = `[gcode_macro START_PRINT]
gcode:
    # Get parameters from slicer
    {% set BED_TEMP = params.BED_TEMP|default(60)|float %}
    {% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(200)|float %}`;

    if (startOptions.chamberTemp > 0) {
      macro += `
    {% set CHAMBER_TEMP = params.CHAMBER_TEMP|default(${startOptions.chamberTemp})|float %}`;
    }

    if (startOptions.filamentType) {
      macro += `
    {% set FILAMENT_TYPE = params.FILAMENT_TYPE|default("PLA")|string %}`;
    }

    macro += `
    
    # Start sequence
    M117 Starting print...
    G90                                    # Absolute positioning
    M83                                    # Relative extruder mode`;

    if (startOptions.beep) {
      macro += `
    M300 S1000 P100                        # Beep`;
    }

    if (startOptions.homingOverride) {
      macro += `
    
    # Homing
    G28                                    # Home all axes`;
    } else {
      macro += `
    
    # Homing (add your custom homing routine)
    G28`;
    }

    if (startOptions.qglBeforePrint) {
      macro += `
    
    # Quad Gantry Level
    M117 QGL...
    QUAD_GANTRY_LEVEL
    G28 Z                                  # Re-home Z after QGL`;
    }

    if (startOptions.zTilt) {
      macro += `
    
    # Z-Tilt Adjustment
    M117 Z-Tilt...
    Z_TILT_ADJUST
    G28 Z                                  # Re-home Z after tilt`;
    }

    macro += `
    
    # Heat bed and wait`;
    
    if (startOptions.heatSoak) {
      macro += `
    M117 Heating bed to {BED_TEMP}¬∞C...
    M190 S{BED_TEMP}                       # Set and wait for bed temp
    
    # Heat soak
    M117 Heat soaking for ${startOptions.soakTime} minutes...
    G4 P${startOptions.soakTime * 60000}   # Wait for heat soak`;
    } else {
      macro += `
    M117 Heating bed...
    M190 S{BED_TEMP}                       # Set and wait for bed temp`;
    }

    if (startOptions.nozzlePreHeat > 0) {
      macro += `
    
    # Pre-heat nozzle for probing
    M117 Pre-heating nozzle...
    M109 S${startOptions.nozzlePreHeat}    # Set and wait for nozzle preheat`;
    }

    if (startOptions.bedMeshCalibrate) {
      macro += `
    
    # Calibrate bed mesh
    M117 Calibrating bed mesh...`;
      
      if (startOptions.adaptiveMesh) {
        macro += `
    BED_MESH_CALIBRATE ADAPTIVE=1          # Adaptive mesh based on print area`;
      } else {
        macro += `
    BED_MESH_CALIBRATE                     # Full bed mesh`;
      }
    } else if (startOptions.bedMeshLoad) {
      macro += `
    
    # Load bed mesh
    M117 Loading bed mesh...
    BED_MESH_PROFILE LOAD=default          # Load saved mesh`;
    }

    macro += `
    
    # Heat nozzle to print temp
    M117 Heating nozzle to {EXTRUDER_TEMP}¬∞C...
    M109 S{EXTRUDER_TEMP}                  # Set and wait for nozzle temp`;

    if (startOptions.chamberTemp > 0) {
      macro += `
    
    # Wait for chamber temp (if equipped)
    M117 Waiting for chamber...
    TEMPERATURE_WAIT SENSOR="temperature_sensor chamber" MINIMUM={CHAMBER_TEMP}`;
    }

    if (startOptions.skewCorrection) {
      macro += `
    
    # Apply skew correction
    SKEW_PROFILE LOAD=my_skew_profile`;
    }

    if (startOptions.pressureAdvance) {
      macro += `
    
    # Set pressure advance based on filament type
    {% if FILAMENT_TYPE == "PLA" %}
        SET_PRESSURE_ADVANCE ADVANCE=0.05
    {% elif FILAMENT_TYPE == "PETG" %}
        SET_PRESSURE_ADVANCE ADVANCE=0.08
    {% elif FILAMENT_TYPE == "ABS" %}
        SET_PRESSURE_ADVANCE ADVANCE=0.04
    {% elif FILAMENT_TYPE == "TPU" %}
        SET_PRESSURE_ADVANCE ADVANCE=0.0
    {% endif %}`;
    }

    if (startOptions.velocityLimits) {
      macro += `
    
    # Set velocity limits
    {% if FILAMENT_TYPE == "TPU" %}
        SET_VELOCITY_LIMIT VELOCITY=60 ACCEL=1000
    {% else %}
        SET_VELOCITY_LIMIT VELOCITY=300 ACCEL=3000
    {% endif %}`;
    }

    if (startOptions.fanSpeed > 0) {
      macro += `
    
    # Set part cooling fan
    M106 S${Math.round(startOptions.fanSpeed * 2.55)}  # Set fan to ${startOptions.fanSpeed}%`;
    }

    if (startOptions.purgeLineType !== 'none') {
      macro += `
    
    # Purge line`;
      
      if (startOptions.purgeLineType === 'adaptive') {
        macro += `
    M117 Adaptive purge...
    ADAPTIVE_PURGE                         # Adaptive purge near print`;
      } else if (startOptions.purgeLineType === 'line_front') {
        macro += `
    M117 Purge line...
    G1 Z2.0 F3000                          # Move Z up
    G1 X10 Y10 Z0.3 F5000                  # Move to start position
    G1 X10 Y200 Z0.3 F1500 E15             # Draw purge line
    G1 X12 Y200 Z0.3 F5000                 # Move over
    G1 X12 Y10 Z0.3 F1500 E30              # Draw second line
    G92 E0                                 # Reset extruder
    G1 Z2.0 F3000                          # Move Z up`;
      } else if (startOptions.purgeLineType === 'blob') {
        macro += `
    M117 Prime blob...
    G1 X10 Y10 Z0.3 F5000                  # Move to blob position
    G1 E10 F300                            # Extrude blob
    G92 E0                                 # Reset extruder
    G1 Z2.0 F3000                          # Move Z up`;
      }
    }

    if (startOptions.primeBlobSize > 0) {
      macro += `
    
    # Additional prime blob
    G1 E${startOptions.primeBlobSize} F300 # Extra prime
    G92 E0                                 # Reset extruder`;
    }

    macro += `
    
    # Ready to print
    M117 Printing...
    G92 E0                                 # Reset extruder position`;

    return macro;
  };

  const generateEndMacro = () => {
    let macro = `[gcode_macro END_PRINT]
gcode:
    # Get print stats
    {% set RAN = printer.print_stats.print_duration %}
    
    M117 Print complete!`;

    if (endOptions.beep) {
      macro += `
    M300 S1000 P200                        # Beep twice
    G4 P100
    M300 S1000 P200`;
    }

    macro += `
    
    # Retract filament`;
    if (endOptions.retract > 0) {
      macro += `
    G91                                    # Relative positioning
    G1 E-${endOptions.retract} F2700       # Retract ${endOptions.retract}mm
    G90                                    # Absolute positioning`;
    }

    if (endOptions.partCooling) {
      macro += `
    
    # Part cooling
    M106 S255                              # Fan to 100%`;
    }

    macro += `
    
    # Move toolhead away`;
    
    let parkX = '10';
    let parkY = '10';
    
    if (endOptions.parkPosition === 'back_center') {
      parkX = 'printer.toolhead.axis_maximum.x / 2';
      parkY = 'printer.toolhead.axis_maximum.y - 10';
    } else if (endOptions.parkPosition === 'back_left') {
      parkX = '10';
      parkY = 'printer.toolhead.axis_maximum.y - 10';
    } else if (endOptions.parkPosition === 'back_right') {
      parkX = 'printer.toolhead.axis_maximum.x - 10';
      parkY = 'printer.toolhead.axis_maximum.y - 10';
    } else if (endOptions.parkPosition === 'front_center') {
      parkX = 'printer.toolhead.axis_maximum.x / 2';
      parkY = '10';
    }

    let parkZ = '';
    if (endOptions.parkZ === 'max') {
      parkZ = `
    {% set max_z = printer.toolhead.axis_maximum.z|float %}
    {% set cur_z = printer.toolhead.position.z|float %}
    {% if cur_z < (max_z - 5) %}
        G1 Z{max_z - 5} F600               # Move to near max Z
    {% endif %}`;
    } else if (endOptions.parkZ === 'relative') {
      parkZ = `
    G91                                    # Relative positioning
    G1 Z10 F600                            # Move Z up 10mm
    G90                                    # Absolute positioning`;
    }

    macro += `${parkZ}
    G1 X{${parkX}} Y{${parkY}} F6000       # Park toolhead`;

    if (endOptions.presentPart) {
      macro += `
    
    # Present part
    {% set max_z = printer.toolhead.axis_maximum.z|float %}
    G1 Z{max_z * 0.8} F600                 # Lower bed for part removal`;
    }

    if (endOptions.fanCooldown && endOptions.cooldownTime > 0) {
      macro += `
    
    # Cool down with fan
    M117 Cooling for ${endOptions.cooldownTime}s...
    G4 P${endOptions.cooldownTime * 1000}  # Wait while cooling`;
    }

    macro += `
    
    # Turn off heaters`;
    
    if (!endOptions.bedOff) {
      macro += `
    M104 S0                                # Turn off hotend`;
    } else {
      macro += `
    M104 S0                                # Turn off hotend
    M140 S0                                # Turn off bed`;
    }

    if (endOptions.partCooling) {
      macro += `
    M107                                   # Turn off part cooling fan`;
    }

    if (endOptions.disableSteppers) {
      macro += `
    
    # Disable steppers
    M84                                    # Disable all steppers`;
    }

    macro += `
    
    # Print complete message
    M117 Done! Time: {RAN//3600}h {(RAN%3600)//60}m {RAN%60}s`;

    return macro;
  };

  const fullMacro = `${generateStartMacro()}

${generateEndMacro()}`;

  const copyToClipboard = () => {
    navigator.clipboard.writeText(fullMacro);
    setCopied(true);
    setTimeout(() => setCopied(false), 2000);
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-gray-900 p-6">
      <div className="max-w-7xl mx-auto">
        <div className="text-center mb-8">
          <h1 className="text-4xl font-bold text-white mb-2">Klipper Macro Builder</h1>
          <p className="text-blue-200">Visually configure your START_PRINT and END_PRINT macros</p>
        </div>

        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
          {/* START_PRINT Configuration */}
          <div className="bg-white/10 backdrop-blur-lg rounded-lg p-6 border border-white/20">
            <h2 className="text-2xl font-bold text-white mb-4">üöÄ START_PRINT Options</h2>
            
            <div className="space-y-4">
              <div className="bg-white/5 p-4 rounded">
                <h3 className="text-lg font-semibold text-blue-300 mb-3">Bed Leveling</h3>
                
                <label className="flex items-center text-white mb-2">
                  <input
                    type="checkbox"
                    checked={startOptions.bedMeshLoad}
                    onChange={(e) => updateStartOption('bedMeshLoad', e.target.checked)}
                    disabled={startOptions.bedMeshCalibrate}
                    className="mr-2 w-4 h-4"
                  />
                  Load Saved Bed Mesh
                </label>
                
                <label className="flex items-center text-white mb-2">
                  <input
                    type="checkbox"
                    checked={startOptions.bedMeshCalibrate}
                    onChange={(e) => updateStartOption('bedMeshCalibrate', e.target.checked)}
                    className="mr-2 w-4 h-4"
                  />
                  Calibrate Bed Mesh
                </label>
                
                {startOptions.bedMeshCalibrate && (
                  <label className="flex items-center text-white ml-6 mb-2">
                    <input
                      type="checkbox"
                      checked={startOptions.adaptiveMesh}
                      onChange={(e) => updateStartOption('adaptiveMesh', e.target.checked)}
                      className="mr-2 w-4 h-4"
                    />
                    Adaptive Mesh (print area only)
                  </label>
                )}
                
                <label className="flex items-center text-white mb-2">
                  <input
                    type="checkbox"
                    checked={startOptions.qglBeforePrint}
                    onChange={(e) => updateStartOption('qglBeforePrint', e.target.checked)}
                    className="mr-2 w-4 h-4"
                  />
                  Quad Gantry Level (QGL)
                </label>
                
                <label className="flex items-center text-white">
                  <input
                    type="checkbox"
                    checked={startOptions.zTilt}
                    onChange={(e) => updateStartOption('zTilt', e.target.checked)}
                    className="mr-2 w-4 h-4"
                  />
                  Z-Tilt Adjustment
                </label>
              </div>

              <div className="bg-white/5 p-4 rounded">
                <h3 className="text-lg font-semibold text-blue-300 mb-3">Heating</h3>
                
                <label className="flex items-center text-white mb-2">
                  <input
                    type="checkbox"
                    checked={startOptions.heatSoak}
                    onChange={(e) => updateStartOption('heatSoak', e.target.checked)}
                    className="mr-2 w-4 h-4"
                  />
                  Heat Soak
                </label>
                
                {startOptions.heatSoak && (
                  <div className="ml-6 mb-3">
                    <label className="block text-white mb-1">Soak Time (minutes)</label>
                    <input
                      type="number"
                      value={startOptions.soakTime}
                      onChange={(e) => updateStartOption('soakTime', parseInt(e.target.value))}
                      className="w-24 px-2 py-1 rounded bg-white/10 text-white border border-white/20"
                      min="0"
                      max="30"
                    />
                  </div>
                )}
                
                <div className="mb-3">
                  <label className="block text-white mb-1">Nozzle Pre-Heat Temp (¬∞C)</label>
                  <input
                    type="number"
                    value={startOptions.nozzlePreHeat}
                    onChange={(e) => updateStartOption('nozzlePreHeat', parseInt(e.target.value))}
                    className="w-24 px-2 py-1 rounded bg-white/10 text-white border border-white/20"
                    min="0"
                    max="200"
                  />
                  <p className="text-xs text-blue-200 mt-1">For probing without ooze (0 to disable)</p>
                </div>
                
                <div>
                  <label className="block text-white mb-1">Chamber Temp (¬∞C)</label>
                  <input
                    type="number"
                    value={startOptions.chamberTemp}
                    onChange={(e) => updateStartOption('chamberTemp', parseInt(e.target.value))}
                    className="w-24 px-2 py-1 rounded bg-white/10 text-white border border-white/20"
                    min="0"
                    max="80"
                  />
                  <p className="text-xs text-blue-200 mt-1">If chamber sensor equipped (0 to disable)</p>
                </div>
              </div>

              <div className="bg-white/5 p-4 rounded">
                <h3 className="text-lg font-semibold text-blue-300 mb-3">Purge & Prime</h3>
                
                <div className="mb-3">
                  <label className="block text-white mb-1">Purge Line Type</label>
                  <select
                    value={startOptions.purgeLineType}
                    onChange={(e) => updateStartOption('purgeLineType', e.target.value)}
                    className="w-full px-2 py-1 rounded bg-white/10 text-white border border-white/20"
                  >
                    <option value="none">None</option>
                    <option value="adaptive">Adaptive (near print)</option>
                    <option value="line_front">Front Line</option>
                    <option value="blob">Prime Blob</option>
                  </select>
                </div>
                
                <div>
                  <label className="block text-white mb-1">Extra Prime (mm)</label>
                  <input
                    type="number"
                    value={startOptions.primeBlobSize}
                    onChange={(e) => updateStartOption('primeBlobSize', parseInt(e.target.value))}
                    className="w-24 px-2 py-1 rounded bg-white/10 text-white border border-white/20"
                    min="0"
                    max="20"
                  />
                </div>
              </div>

              <div className="bg-white/5 p-4 rounded">
                <h3 className="text-lg font-semibold text-blue-300 mb-3">Advanced</h3>
                
                <label className="flex items-center text-white mb-2">
                  <input
                    type="checkbox"
                    checked={startOptions.filamentType}
                    onChange={(e) => updateStartOption('filamentType', e.target.checked)}
                    className="mr-2 w-4 h-4"
                  />
                  Filament Type Parameter
                </label>
                
                <label className="flex items-center text-white mb-2">
                  <input
                    type="checkbox"
                    checked={startOptions.pressureAdvance}
                    onChange={(e) => updateStartOption('pressureAdvance', e.target.checked)}
                    className="mr-2 w-4 h-4"
                  />
                  Auto Pressure Advance (by filament)
                </label>
                
                <label className="flex items-center text-white mb-2">
                  <input
                    type="checkbox"
                    checked={startOptions.velocityLimits}
                    onChange={(e) => updateStartOption('velocityLimits', e.target.checked)}
                    className="mr-2 w-4 h-4"
                  />
                  Auto Velocity Limits (by filament)
                </label>
                
                <label className="flex items-center text-white mb-3">
                  <input
                    type="checkbox"
                    checked={startOptions.skewCorrection}
                    onChange={(e) => updateStartOption('skewCorrection', e.target.checked)}
                    className="mr-2 w-4 h-4"
                  />
                  Skew Correction
                </label>
                
                <div>
                  <label className="block text-white mb-1">Initial Fan Speed (%)</label>
                  <input
                    type="number"
                    value={startOptions.fanSpeed}
                    onChange={(e) => updateStartOption('fanSpeed', parseInt(e.target.value))}
                    className="w-24 px-2 py-1 rounded bg-white/10 text-white border border-white/20"
                    min="0"
                    max="100"
                  />
                </div>
              </div>
            </div>
          </div>

          {/* END_PRINT Configuration */}
          <div className="bg-white/10 backdrop-blur-lg rounded-lg p-6 border border-white/20">
            <h2 className="text-2xl font-bold text-white mb-4">üèÅ END_PRINT Options</h2>
            
            <div className="space-y-4">
              <div className="bg-white/5 p-4 rounded">
                <h3 className="text-lg font-semibold text-blue-300 mb-3">Toolhead Parking</h3>
                
                <div className="mb-3">
                  <label className="block text-white mb-1">Park Position</label>
                  <select
                    value={endOptions.parkPosition}
                    onChange={(e) => updateEndOption('parkPosition', e.target.value)}
                    className="w-full px-2 py-1 rounded bg-white/10 text-white border border-white/20"
                  >
                    <option value="back_center">Back Center</option>
                    <option value="back_left">Back Left</option>
                    <option value="back_right">Back Right</option>
                    <option value="front_center">Front Center</option>
                  </select>
                </div>
                
                <div className="mb-3">
                  <label className="block text-white mb-1">Z Position</label>
                  <select
                    value={endOptions.parkZ}
                    onChange={(e) => updateEndOption('parkZ', e.target.value)}
                    className="w-full px-2 py-1 rounded bg-white/10 text-white border border-white/20"
                  >
                    <option value="max">Near Max Z</option>
                    <option value="relative">+10mm Relative</option>
                  </select>
                </div>
                
                <label className="flex items-center text-white">
                  <input
                    type="checkbox"
                    checked={endOptions.presentPart}
                    onChange={(e) => updateEndOption('presentPart', e.target.checked)}
                    className="mr-2 w-4 h-4"
                  />
                  Present Part (lower bed)
                </label>
              </div>

              <div className="bg-white/5 p-4 rounded">
                <h3 className="text-lg font-semibold text-blue-300 mb-3">Retraction</h3>
                
                <div>
                  <label className="block text-white mb-1">Retract Distance (mm)</label>
                  <input
                    type="number"
                    value={endOptions.retract}
                    onChange={(e) => updateEndOption('retract', parseFloat(e.target.value))}
                    className="w-24 px-2 py-1 rounded bg-white/10 text-white border border-white/20"
                    min="0"
                    max="20"
                    step="0.5"
                  />
                </div>
              </div>

              <div className="bg-white/5 p-4 rounded">
                <h3 className="text-lg font-semibold text-blue-300 mb-3">Cooling</h3>
                
                <label className="flex items-center text-white mb-2">
                  <input
                    type="checkbox"
                    checked={endOptions.partCooling}
                    onChange={(e) => updateEndOption('partCooling', e.target.checked)}
                    className="mr-2 w-4 h-4"
                  />
                  Part Cooling Fan
                </label>
                
                <label className="flex items-center text-white mb-2">
                  <input
                    type="checkbox"
                    checked={endOptions.fanCooldown}
                    onChange={(e) => updateEndOption('fanCooldown', e.target.checked)}
                    className="mr-2 w-4 h-4"
                  />
                  Fan Cooldown Period
                </label>
                
                {endOptions.fanCooldown && (
                  <div className="ml-6">
                    <label className="block text-white mb-1">Cooldown Time (seconds)</label>
                    <input
                      type="number"
                      value={endOptions.cooldownTime}
                      onChange={(e) => updateEndOption('cooldownTime', parseInt(e.target.value))}
                      className="w-24 px-2 py-1 rounded bg-white/10 text-white border border-white/20"
                      min="0"
                      max="300"
                    />
                  </div>
                )}
              </div>

              <div className="bg-white/5 p-4 rounded">
                <h3 className="text-lg font-semibold text-blue-300 mb-3">Power Down</h3>
                
                <label className="flex items-center text-white mb-2">
                  <input
                    type="checkbox"
                    checked={endOptions.bedOff}
                    onChange={(e) => updateEndOption('bedOff', e.target.checked)}
                    className="mr-2 w-4 h-4"
                  />
                  Turn Off Bed Heater
                </label>
                
                <label className="flex items-center text-white mb-2">
                  <input
                    type="checkbox"
                    checked={endOptions.disableSteppers}
                    onChange={(e) => updateEndOption('disableSteppers', e.target.checked)}
                    className="mr-2 w-4 h-4"
                  />
                  Disable Steppers (M84)
                </label>
                
                <label className="flex items-center text-white">
                  <input
                    type="checkbox"
                    checked={endOptions.beep}
                    onChange={(e) => updateEndOption('beep', e.target.checked)}
                    className="mr-2 w-4 h-4"
                  />
                  Completion Beep
                </label>
              </div>
            </div>
          </div>
        </div>

        {/* Generated Macro Output */}
        <div className="bg-white/10 backdrop-blur-lg rounded-lg p-6 border border-white/20">
          <div className="flex justify-between items-center mb-4">
            <h2 className="text-2xl font-bold text-white">üìù Generated Macros</h2>
            <button
              onClick={copyToClipboard}
              className="flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors"
            >
              {copied ? <Check size={20} /> : <Copy size={20} />}
              {copied ? 'Copied!' : 'Copy to Clipboard'}
            </button>
          </div>
          
          <div className="bg-gray-900 rounded-lg p-4 overflow-x-auto">
            <pre className="text-green-400 text-sm font-mono whitespace-pre">
              {fullMacro}
            </pre>
          </div>
          
          <div className="mt-4 p-4 bg-blue-900/30 rounded-lg border border-blue-500/30">
            <h3 className="text-lg font-semibold text-blue-300 mb-2">üí° Usage Instructions</h3>
            <ul className="text-blue-100 text-sm space-y-1">
              <li>1. Copy the generated macros above</li>
              <li>2. Paste into your <code className="bg-black/30 px-1 rounded">printer.cfg</code> or a separate macros file</li>
              <li>3. Configure your slicer to call START_PRINT and END_PRINT</li>
              <li>4. In your slicer, pass parameters: <code className="bg-black/30 px-1 rounded">START_PRINT BED_TEMP=[bed_temperature] EXTRUDER_TEMP=[nozzle_temperature]</code></li>
              {startOptions.filamentType && <li>5. Optional: Add <code className="bg-black/30 px-1 rounded">FILAMENT_TYPE=[filament_type]</code> parameter</li>}
            </ul>
          </div>
        </div>
      </div>
    </div>
  );
}

        // Inline Lucide icons
        const Copy = ({ size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <rect width="14" height="14" x="8" y="8" rx="2" ry="2" />
                <path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2" />
            </svg>
        );

        const Check = ({ size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M20 6 9 17l-5-5" />
            </svg>
        );

        const ChevronDown = ({ size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m6 9 6 6 6-6" />
            </svg>
        );

        const ChevronUp = ({ size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m18 15-6-6-6 6" />
            </svg>
        );

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<KlipperMacroBuilder />);
    </script>
</body>
</html>
